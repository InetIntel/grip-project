#  This software is Copyright (c) 2015 The Regents of the University of
#  California. All Rights Reserved. Permission to copy, modify, and distribute this
#  software and its documentation for academic research and education purposes,
#  without fee, and without a written agreement is hereby granted, provided that
#  the above copyright notice, this paragraph and the following three paragraphs
#  appear in all copies. Permission to make use of this software for other than
#  academic research and education purposes may be obtained by contacting:
#
#  Office of Innovation and Commercialization
#  9500 Gilman Drive, Mail Code 0910
#  University of California
#  La Jolla, CA 92093-0910
#  (858) 534-5815
#  invent@ucsd.edu
#
#  This software program and documentation are copyrighted by The Regents of the
#  University of California. The software program and documentation are supplied
#  "as is", without any accompanying services from The Regents. The Regents does
#  not warrant that the operation of the program will be uninterrupted or
#  error-free. The end-user understands that the program was developed for research
#  purposes and is advised not to rely exclusively on the program for any reason.
#
#  IN NO EVENT SHALL THE UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR
#  DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST
#  PROFITS, ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
#  THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
#  DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
#  FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE PROVIDED HEREUNDER IS ON AN "AS
#  IS" BASIS, AND THE UNIVERSITY OF CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE
#  MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.

from unittest import TestCase

from grip.events.pfxevent import PfxEvent
from grip.events.pfxevent_parser import PfxEventParser
from grip.tagger.tags import tagshelper

EDGES_LINE = "1588205400|136620-8551|NEW|79.180.229.0/24|48571 8708 8551:31313 6830 6762 8551:56430 8708 8551:11039 6461 8551:6830 6762 8551:293 6939 8551:2914 6762 8551:19151 174 6762 8551:5769 6453 6762 8551:41095 8551:6079 3356 6762 8551:6939 8551:37468 8551:20080 6762 8551:51185 3356 6762 8551:393950 6939 8551:57695 3223 8551:52320 6461 8551:8220 1299 6762 8551:3257 6762 8551:6830 6762 8551:47692 8551:35369 8218 8551:47147 8551:8218 8551:6720 8447 8551:13237 8551:7195 3549 3356 6762 8551:42473 9002 8551:49515 174 6762 8551:6667 8551:9002 8551:20764 8551:24482 8551:13030 8551:19151 2914 6762 8551:51185 3356 6762 8551:9002 8551:24482 8551:9304 174 6762 8551:2497 2914 6762 8551:397143 3257 6762 8551:2497 2914 6762 8551:37697 8551:25152 6939 8551:3491 6762 8551:4777 2516 6762 8551:37497 8551:37239 8551:37640 8551:37468 8551:57695 35487 328383 327782 37100 8551:37271 8551:64271 8551:42473 8551:14630 6461 8551:8607 8551:2914 6762 8551:13030 8551:286 6762 8551:25160 8551:6908 2914 6762 8551:62167 8551:8896 8551:7489 8551:12779 8551:60501 8551:39122 8551:207044 8551:57695 8551:60945 8551:51185 8551:8218 8551:6894 8551:6908 2914 6762 8551:31742 8551:35266 8551:15605 8551:57111 6762 8551:5602 6762 8551:51185 8551:49605 8551:24482 8551:50877 8551:5396 6762 8551:5392 3356 6762 8551:12779 8551:12637 3257 6762 8551:20811 8551:41327 8551:20912 3257 6762 8551:8660 1267 8551:14907 1299 6762 8551:25227 9002 8551:18106 8551:9002 8551:20764 8551:24482 8551:42275 25091 8551:49434 35280 8551:35600 30781 8551:34019 8551:41157 29075 8551:50628 3356 6762 8551:2914 6762 8551:63956 3491 6762 8551:41722 20764 8551:28917 8551:39821 9002 8551:14061 6453 6762 8551:19151 174 6762 8551:51873 6939 8551:7575 6762 8551:34019 8551:49605 8551:14907 6461 8551:58308 29075 8551:53070 2914 6762 8551:28634 37468 8551:28634 37468 8551:13786 8551:64271 262287 16735 3356 6762 8551:24482 8551:41095 8551 64635:196621 8758 8551:8218 8551:198385 8551:8218 8551:198290 6661 8551:51405 206610 6661 8551:204355 174 6762 8551:15547 8551:58308 29075 8551:12779 8551:59689 30781 8551:20766 8551:29075 8551:24482 8551:2613 6893 6730 8551:57199 35280 8551:34177 8551:16347 8551:8426 8551:205344 3356 6762 8551:8218 8551:2895 8732 8551:51907 8551:25091 8551:29479 9002 8551:20612 9044 8551:25091 8551:20612 9044 8551:39533 6762 8551:58299 6939 8551:56665 8551:1916 2914 6762 8551:22548 6939 8551:16735 3356 6762 8551:23106 28329 6762 8551:52863 3356 6762 8551:28186 8551:57695 262287 16735 3356 6762 8551:52873 8551:267613 8551:28260 26615 6762 8551:263152 28329 6762 8551:262757 4230 6762 8551:28186 8551:59891 136620 8551:15547 8551:31424 13030 8551:58057 3303 8551:62167 8551:24482 8551:51786 15623 43531 8551:21232 13030 8551:47147 8551:8758 8551:202194 198385 8551:12307 29691 13030 8551:29691 13030 8551:59414 13030 8551:25091 8551:24516 1299 6762 8551:14061 4637 8551:205206 1299 6762 8551:3280 8551:513 21320 8551:29222 3303 8551:29680 8220 8551:43578 1299 6762 8551:24482 8551:6939 8551:6082 2914 6762 8551:20932 8551:12350 174 6762 8551:2497 2914 6762 8551:7575 6762 8551:27446 27446 6939 8551:37497 8551:8220 6453 6762 8551:328145 8551:3491 6762 8551:137831 4657 8551:37468 8551:58511 8551:17639 8551:15547 8551:32354 174 6762 8551:34019 8551:47692 8551:25091 8551:14061 6453 6762 8551:26073 6939 8551:6939 8551:36351 8551:14361 3257 6762 8551:19151 174 6762 8551:4181 1299 6762 8551:61955 8551:51088 6453 6762 8551:39120 3356 6762 8551:1103 8551:293 6939 8551:6830 6762 8551:267613 8551:5394 8551:12859 8551:64475 8551:13030 8551:6939 8551:28329 6762 8551:2497 2914 6762 8551:19653 6461 8551:395570 6939 8551:293 6939 8551:53828 2914 6762 8551:32709 6939 8551:19151 2914 6762 8551:19016 3257 6762 8551:14630 3356 6762 8551:852 3356 6762 8551:14630 3356 6762 8551:47692 8551:51088 6453 6762 8551:34019 8551:50673 9002 8551:64271 3214 3356 6762 8551:42541 3356 6762 8551:209650 209844 56381 205614 8551:30132 20562 8551:15435 3257 6762 8551:12859 8551:1103 8551:6423 6461 8551:53828 2914 6762 8551:15008 40805 6939 8551:3491 6762 8551:58511 8551:55222 6939 8551:19653 6461 8551:38001 3491 6762 8551:23367 6461 8551:39120 8551:39120 8551:39120 8551:3402 3356 6762 8551:29479 9002 8551:39351 8551:3257 6762 8551:3561 209 3356 6762 8551:3292 6762 8551:6939 8551:42541 3356 6762 8551:23367 6461 8551:45352 8551:61568 6762 8551:14840 8551:46450 2914 6762 8551:63927 8551:286 6762 8551:5650 3356 6762 8551:209 3356 6762 8551:209 3356 6762 8551:209 3356 6762 8551:40387 23473 6939 8551:40630 6939 8551:202365 50673 9002 8551:5645 1299 6762 8551:52320 6461 8551:61832 2914 6762 8551:1916 2914 6762 8551:262757 4230 6762 8551:52863 3356 6762 8551:28571 1916 2914 6762 8551:58511 8551:7500 2516 6762 8551:27678 27986 6762 8551:1798 6461 8551:20953 174 6762 8551:39591 174 6762 8551:58511 8551:34968 8455 8551:12779 8551:1103 8551:31019 8551:19151 2914 6762 8551:8218 8551:29686 8551:24961 8551:553 8551:6762 8551:680 1299 1299 6762 8551:57695 8551:6908 2914 6762 8551:2914 6762 8551:48919 8551:34288 8551:20811 8551:25220 8551:29140 8551:8222 8551:60501 8551:47147 8551:206356 8551:58057 8551:49697 8551:47950 8551:34927 8551:39533 6453 6762 8551:7713 8551:7713 8551:137831 4657 8551:3491 6762 8551:63956 3491 6762 8551:18106 8551:58511 8551:38726 6939 8551:45177 4637 8551:58511 8551:2497 2914 6762 8551:1280 6762 8551:6762 8551:6908 2914 6762 8551:6453 6762 8551:14907 6762 8551:8218 8551:29467 8551:59605 8551:8283 6762 8551:8455 8551:199938 8551:47147 8551:60501 8551:204708 20766 8551:58511 8551:58511 8551:58511 8551:58511 8551:24482 8551:4739 7545 6939 8551:3267 2603 8551:39120 3356 6762 8551:39120 8551:19754 1299 6762 8551:1299 6762 8551:34288 8551:133950 9790 4826 15412 8551:38726 9957 4766 6762 8551:36236 8551:2914 6762 8551:2518 6453 6762 8551:63956 1299 6762 8551:42541 3356 6762 8551:61568 6762 8551:59469 1299 6762 8551:38883 6939 8551:56665 8551:204028 6830 6762 8551:1351 6939 8551:38880 8551:7575 6762 8551:58511 8551:3491 6762 8551:24516 1299 6762 8551:4826 15412 8551:38880 8551:6939 8551:34224 8551:53767 3257 6762 8551:54728 20130 6939 8551:18106 8551:49788 12552 8551:3277 3267 2603 8551:3130 2914 6762 8551:20912 3257 6762 8551:23673 3491 6762 8551:852 3356 6762 8551:3130 2914 6762 8551:2914 6762 8551:8492 8551:31019 8551:24441 3491 3491 6762 8551:1239 6762 8551:57866 6762 8551:57463 8551:3257 6762 8551:7018 6762 8551:22652 6453 6762 8551:3741 8551:1403 6461 8551:1299 6762 8551:286 6762 8551:2152 3356 6762 8551:293 6939 8551:1403 6461 8551:701 6762 8551:11686 6939 8551:6939 8551:3549 3356 6762 8551:3549 3356 6762 8551:2497 2914 6762 8551:3561 209 3356 6762 8551:1221 4637 8551:3303 8551:5413 8551:37100 8551:7660 2516 6762 8551:"
MOAS_LINE = "1588205400|168.195.168.0/22|NEW|37497 6939 52320 262807 265436:3491 6939 52320 262807 265436:37239 6939 52320 262760 265436:37640 6939 52320 262760 265436:37468 6939 52320 262807 265436:57695 6939 52320 262807 265436:37271 52320 262807 265436:37697 265436:29680 15704 52320 262807 265436:43578 6939 52320 262807 265436:11039 6939 52320 262760 265436:6830 6762 262760 265436:293 6939 52320 262760 265436:2914 6762 262760 265436:19151 6939 52320 262760 265436:5769 1299 6762 262760 265436:41095 52320 262760 265436:6079 6939 52320 262760 265436:6939 52320 262760 265436:37468 6939 52320 262760 265436:57695 6939 52320 262760 265436:8220 6939 52320 262760 265436:3257 3356 3549 262807 265436:6830 6762 262760 265436:15605 3356 3549 262807 265436:57111 6939 52320 262807 265436:5602 6939 52320 262807 265436:42473 9002 52320 262807 265436:14907 6939 52320 262807 265436:18106 52320 262807 265436:63956 6939 52320 262807 265436:49515 174 3356 3549 262807 265436:6667 6939 52320 262807 265436:9002 52320 262807 265436:20764 6939 52320 262807 265436:51185 52320 262807 265436:6423 6939 52320 262807 265436:24482 52320 262807 265436:1798 6939 52320 262807 265436:47692 6939 52320 262807 265436:32354 6939 52320 262807 265436:14061 6939 52320 262807 265436:26073 6939 52320 262807 265436:25227 9002 52320 262807 265436:53070 265436:28634 265436:37497 6939 52320 262807 265436:49605 52320 262807 265436:24482 6939 52320 262807 265436:328145 6939 52320 262760 265436:3491 6939 52320 262807 265436:2497 6461 52320 262807 265436:7575 6762 262760 265436 263038:37468 6939 52320 262807 265436:6939 52320 262807 265436:20080 6939 52320 262807 265436:51185 52320 262807 265436:393950 52320 262807 265436:513 6939 52320 262807 265436:48571 6939 52320 262807 265436:64271 6939 52320 262807 265436:9002 52320 262807 265436:20764 6939 52320 262807 265436:24482 6939 52320 262807 265436:41722 9002 52320 262807 265436:28917 6939 52320 262807 265436:39821 9002 52320 262807 265436:41095 52320 262807 265436:2895 3267 6939 52320 262760 265436:51907 6939 52320 262807 265436:29479 6939 52320 262807 265436:25091 6461 52320 262807 265436:55222 6461 52320 262807 265436:19653 6939 52320 262807 265436:6939 52320 262807 265436:6082 2914 3356 3549 262807 265436:27446 27446 6939 52320 262807 265436:38001 6939 52320 262807 265436:4181 6939 52320 262807 265436:23367 6461 52320 262807 265436:53828 6939 52320 262807 265436:15008 6939 52320 262807 265436:3491 3356 3549 262807 265436:19151 52320 262807 265436:39120 6939 52320 262760 265436:39120 6939 52320 262807 265436:2497 6939 52320 262807 265436:42473 1299 52320 262807 265436:14630 6939 52320 262807 265436:4739 7545 1299 52320 262807 265436:39120 6939 52320 262760 265436:28634 265436:36351 52320 262807 265436:35369 6939 52320 262807 265436:8607 6939 52320 262807 265436:2914 6762 262760 265436 263038:13030 52320 262807 265436:286 1299 52320 262807 265436:25160 6939 52320 262807 265436:6908 6939 52320 262807 265436:62167 6939 52320 262807 265436:8896 6939 52320 262807 265436:7489 6939 52320 262807 265436:58511 52320 262807 265436:34224 52320 262807 265436:25152 6939 52320 262807 265436:7195 265436:24516 6939 52320 262807 265436:29222 6461 52320 262807 265436:20932 52320 262807 265436:7575 6939 52320 262807 265436:12350 6939 52320 262807 265436:31313 6939 52320 262807 265436:53767 6939 52320 262807 265436:13030 52320 262807 265436:4777 6939 52320 262807 265436:51873 6939 52320 262807 265436:19151 52320 262807 265436:34019 52320 262807 265436:58511 52320 262807 265436:14361 6939 52320 262807 265436:19151 52320 262807 265436:49605 52320 262807 265436:52320 262807 265436:3491 6939 52320 262807 265436:24516 6939 52320 262807 265436:4826 52320 262807 265436:38880 52320 262807 265436:6939 52320 262807 265436:13786 265436:64271 265436:47147 52320 262807 265436:54728 20130 6939 52320 262807 265436:14061 6939 52320 262807 265436:56430 6939 52320 262807 265436:24482 52320 262807 265436:8220 6939 52320 262807 265436:3402 6939 52320 262760 265436:51185 52320 262807 265436:9002 52320 262807 265436:24482 52320 262807 265436:9304 52320 262807 265436:2497 3356 3549 262807 265436:15547 6939 52320 262807 265436:397143 3257 52320 262807 265436:8218 52320 262807 265436:6720 6939 52320 262807 265436:50877 6939 52320 262807 265436:25091 6461 52320 262807 265436:196621 8758 52320 262807 265436:29479 6939 52320 262807 265436:198385 15576 6939 6939 52320 262760 265436:39351 52320 262807 265436:18106 52320 262807 265436:8218 52320 262807 265436:3257 52320 262807 265436:3561 209 3356 3549 262807 265436:49788 6939 52320 262807 265436:3292 3356 3549 262807 265436:3277 3267 6939 52320 262807 265436:6939 52320 262807 265436:3130 1239 3356 3549 262807 265436:20912 6939 52320 262807 265436:23673 6939 52320 262807 265436:852 6461 52320 262807 265436:25091 6461 52320 262807 265436:5396 6939 52320 262807 265436:5392 6939 52320 262807 265436:12779 52320 262807 265436:12637 52320 262807 265436:20811 3356 3549 262807 265436:41327 52320 262807 265436:42541 52320 262807 265436:20912 6939 52320 262807 265436:13237 52320 262807 265436:20612 8758 52320 262807 265436:137831 1299 52320 262807 265436:12779 52320 262807 265436:58511 6939 52320 262807 265436:60501 52320 262807 265436:39122 52320 262807 265436:207044 6939 52320 262807 265436:57695 6939 52320 262807 265436:60945 6939 52320 262807 265436:23367 6461 52320 262807 265436:51185 52320 262807 265436:8218 52320 262807 265436:6894 6461 52320 262807 265436:45352 52320 262807 265436:61568 52320 262807 265436:14840 265436:17639 1299 52320 262807 265436:24482 265436:7713 52320 262807 265436:1916 265436:7713 52320 262807 265436:137831 1299 52320 262807 265436:6908 6939 52320 262807 265436:20612 8758 52320 262807 265436:22548 265436:58299 6939 52320 262760 265436:16735 262760 265436 263038:23106 265436:3491 6939 52320 262807 265436:15547 6939 52320 262807 265436:52863 265436:31424 52320 262807 265436:28186 262760 265436 263038:58057 3303 3356 3549 262807 265436:46450 6939 52320 262807 265436:63956 6939 52320 262807 265436:57695 265436:52873 262760 265436 263038:267613 265436:28260 265436:263152 265436:63927 52320 262807 265436:286 1299 52320 262807 265436:5650 6939 52320 262807 265436:209 3356 3549 262807 265436:209 3356 3549 262807 265436:209 3356 3549 262807 265436:3130 1239 3356 3549 262807 265436:40387 2381 6939 52320 262807 265436:40630 6939 52320 262807 265436:2914 3356 3549 262807 265436:202365 6939 52320 262807 265436:62167 6939 52320 262807 265436:31742 6939 52320 262807 265436:35266 6939 52320 262807 265436:24482 6939 52320 262807 265436:8492 52320 262807 265436:31019 52320 262807 265436:24441 6939 52320 262807 265436:1239 6939 52320 262807 265436:57866 6461 52320 262807 265436:3257 52320 262807 265436:7018 1299 52320 262807 265436:22652 52320 262807 265436:3741 6461 52320 262807 265436:1403 6939 52320 262807 265436:1299 52320 262807 265436:286 3356 3549 262807 265436:2152 6461 52320 262807 265436:293 6939 52320 262760 265436:1403 6939 52320 262807 265436:701 3356 3549 262807 265436:11686 6939 52320 262807 265436:6939 52320 262807 265436:3549 262807 265436:3549 262807 265436:2497 3257 52320 262807 265436:3561 209 3356 3549 262807 265436:1221 4637 6461 52320 262807 265436:3303 3356 3549 262807 265436:51786 15623 43531 52320 262807 265436:21232 15576 52320 262807 265436:47147 52320 262807 265436:8758 52320 262807 265436:202194 198385 15576 52320 262807 265436:12307 29691 13030 52320 262807 265436:29691 13030 52320 262807 265436:59414 13030 52320 262807 265436:18106 52320 262807 265436:5413 6461 52320 262807 265436:37100 6939 52320 262807 265436:262757 265436:8660 1267 52320 262807 265436:28186 262760 265436 263038:2914 6762 262760 265436 263038:205206 33891 52320 262807 265436:14061 6939 52320 262807 265436:19151 52320 262807 265436:7575 6762 262760 265436 263038:14907 6939 52320 262807 265436:2497 6461 52320 262807 265436:1280 1299 52320 262807 265436:6762 262760 265436 263038:42275 25091 6939 52320 262760 265436:19653 6939 52320 262807 265436:61955 52320 262807 265436:51088 6939 52320 262760 265436:58511 52320 262807 265436:58511 52320 262807 265436:38726 6939 52320 262807 265436:13030 52320 262807 265436:2497 6939 52320 262807 265436:395570 6939 52320 262807 265436:293 6939 52320 262807 265436:53828 6939 52320 262807 265436:32709 6939 52320 262807 265436:19151 52320 262807 265436:6939 52320 262807 265436:52320 262807 265436:61832 6939 52320 262807 265436:45177 174 52320 262807 265436:58511 6939 52320 262807 265436:27678 27986 3549 262807 265436:28329 16735 262760 265436:1916 265436:34019 52320 262807 265436:262757 265436:47692 6939 52320 262807 265436:64475 50629 52320 262807 265436:52863 265436:7500 2516 6461 52320 262807 265436:39120 6939 52320 262760 265436:8218 52320 262807 265436:29686 6939 52320 262807 265436:24961 52320 262807 265436:553 6939 52320 262807 265436:6762 262760 265436 263038:680 6939 52320 262807 265436:57695 6939 52320 262807 265436:6908 6939 52320 262807 265436:2914 6762 262760 265436 263038:48919 6939 52320 262807 265436:34288 52320 262807 265436:20811 3356 3549 262807 265436:28571 265436:19016 3257 52320 262807 265436:14630 6939 52320 262807 265436:852 6939 52320 262807 265436:14630 6939 52320 262807 265436:1103 52320 262807 265436:3280 6939 52320 262807 265436:49434 6939 52320 262807 265436:35600 6939 52320 262807 265436:34019 52320 262807 265436:41157 6939 52320 262807 265436:50628 3356 3549 262807 265436:58308 6939 52320 262807 265436:8218 52320 262807 265436:8218 52320 262807 265436:198290 174 52320 262807 265436:51405 6939 52320 262807 265436:204355 52320 262807 265436:15547 6939 52320 262807 265436:58308 6939 52320 262807 265436:12779 52320 262807 265436:59689 6939 52320 262807 265436:20766 52320 262807 265436:29075 52320 262807 265436:24482 52320 262807 265436:2613 6939 52320 262807 265436:57199 35280 6939 52320 262760 265436:34177 6939 52320 262807 265436:16347 6939 52320 262760 265436:8426 6939 52320 262807 265436:39533 6939 52320 262807 265436:56665 6461 52320 262807 265436:25091 6939 52320 262760 265436:293 6939 52320 262807 265436:6830 6939 52320 262807 265436:267613 265436:5394 52320 262807 265436:12859 52320 262807 265436:1140 52320 262807 265436:20953 52320 262807 265436:39591 52320 262807 265436:58511 52320 262807 265436:34968 52320 262807 265436:12779 52320 262807 265436:1103 52320 262807 265436:50763 52320 262807 265436:24875 6939 52320 262807 265436:31019 52320 262807 265436:47692 6939 52320 262807 265436:51088 6939 52320 262760 265436:34019 52320 262807 265436:50673 52320 262807 265436:64271 52320 262807 265436:42541 52320 262807 265436:209650 209844 56381 6939 52320 262807 265436:30132 52320 262807 265436:24875 6939 52320 262807 265436:15435 6939 52320 262807 265436:12859 52320 262807 265436:1103 52320 262807 265436:1140 52320 262807 265436:6908 6939 52320 262807 265436:6453 3356 3549 262807 265436:14907 52320 262807 265436:8218 52320 262807 265436:29467 52320 262807 265436:59605 52320 262807 265436:50763 52320 262807 265436:8283 52320 262807 265436:8455 52320 262807 265436:199938 6939 52320 262760 265436:47147 52320 262807 265436:60501 52320 262807 265436:58511 6939 52320 262807 265436:58511 52320 262807 265436:58511 52320 262807 265436:58511 6939 52320 262807 265436:24482 265436:3267 6939 52320 262807 265436:39120 6939 52320 262760 265436:39120 6939 52320 262760 265436:19754 6939 52320 262807 265436:1299 52320 262807 265436:34288 52320 262807 265436:133950 9790 4826 52320 262807 265436:38726 6939 52320 262807 265436:36236 265436:2914 3356 3549 262807 265436:2518 6939 52320 262807 265436:63956 6939 52320 262807 265436:42541 52320 262807 265436:61568 52320 262807 265436:59469 1299 52320 262807 265436:38883 6939 52320 262807 265436:56665 52320 262807 265436:204028 6830 6461 52320 262807 265436:1351 52320 262807 265436:25220 52320 262807 265436:29140 52320 262807 265436:8222 1299 52320 262807 265436:60501 52320 262807 265436:47147 52320 262807 265436:206356 6939 52320 262807 265436:58057 6939 52320 262807 265436:49697 6939 52320 262807 265436:47950 6939 52320 262807 265436:34927 6939 52320 262807 265436:39533 6939 52320 262807 265436:205344 6939 52320 262760 265436:57463 265436:38880 52320 262807 265436:204708 6939 52320 262807 265436"
SUBMOAS_LINE = "1588205400|202.45.96.0/19|202.45.108.182/32|NEW|4802|4739|42473 1299 4739 4802:11039 6939 7545 7545 4739 4802:6830 1299 4739 4802:293 6453 7545 7545 4739 4802:2914 1299 4739 4802:2914 1299 4739 4802:2497 1299 4739 4802:25152 2914 1299 4739 4802:4777 2500 2500 2500 7660 4635 7545 7545 4739 4802:37697 3491 7545 7545 4739 4802:513 6939 7545 7545 4739 4802:29222 3356 1299 4739 4802:20932 1299 4739 4802:12350 6939 7545 7545 4739 4802:15547 6939 7545 7545 4739 4802:25091 1299 4739 4802:3491 7545 7545 4739 4802:14061 6939 7545 7545 4739 4802:42275 6939 7545 7545 4739 4802:49434 6939 7545 7545 4739 4802:35600 6939 7545 7545 4739 4802:34019 6939 7545 7545 4739 4802:48571 6939 7545 7545 4739 4802:41157 6939 7545 7545 4739 4802:50628 1299 4739 4802:31313 6939 7545 7545 4739 4802:25227 6939 7545 7545 4739 4802:9002 3356 1299 4739 4802:20764 6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:19151 6939 7545 7545 4739 4802:51873 6830 1299 4739 4802:34019 6939 7545 7545 4739 4802:7575 4739 4802:49605 6939 7545 7545 4739 4802:196621 8758 6939 7545 7545 4739 4802:14907 1299 4739 4802:198385 6939 7545 7545 4739 4802:2497 1299 4739 4802:20080 6939 7545 7545 4739 4802:51185 6939 7545 7545 4739 4802:393950 6939 7545 7545 4739 4802:29680 3257 1299 4739 4802:43578 1299 4739 4802:52320 6939 7545 7545 4739 4802:56430 6939 7545 7545 4739 4802:41722 6939 7545 7545 4739 4802:28917 6939 7545 7545 4739 4802:39821 6939 7545 7545 4739 4802:41095 6939 7545 7545 4739 4802:2895 6939 7545 7545 4739 4802:51907 6939 7545 7545 4739 4802:29479 50304 1299 4739 4802:25091 1299 1299 4739 4802:8218 6939 7545 7545 4739 4802:25091 1299 4739 4802:20612 1836 6939 7545 7545 4739 4802:20612 1836 6939 7545 7545 4739 4802:58299 174 1299 4739 4802:15547 6939 7545 7545 4739 4802:31424 6939 7545 7545 4739 4802:58057 174 1299 4739 4802:62167 6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:51786 57118 29691 1299 4739 4802:21232 6830 1299 4739 4802:47147 1299 4739 4802:8758 6939 7545 7545 4739 4802:202194 6893 25091 1299 4739 4802:12307 29691 1299 4739 4802:29691 1299 4739 4802:59414 6830 1299 4739 4802:58308 6939 7545 7545 4739 4802:8218 6939 7545 7545 4739 4802:8218 6939 7545 7545 4739 4802:198290 2914 1299 4739 4802:51405 6939 7545 7545 4739 4802:204355 174 1299 4739 4802:15547 6939 7545 7545 4739 4802:58308 6939 7545 7545 4739 4802:12779 6939 7545 7545 4739 4802:59689 6939 7545 7545 4739 4802:20766 6939 7545 7545 4739 4802:29075 1299 4739 4802:24482 6939 7545 7545 4739 4802:2613 6939 7545 7545 4739 4802:57199 50628 1299 4739 4802:34177 6939 7545 7545 4739 4802:16347 6939 7545 7545 4739 4802:8426 6939 7545 7545 4739 4802:205344 6939 7545 7545 4739 4802:39533 6939 7545 7545 4739 4802:56665 1299 4739 4802:25091 1299 4739 4802:19151 6939 7545 7545 4739 4802:1280 1299 4739 4802:6762 1299 4739 4802:5769 1299 4739 4802:41095 6939 7545 7545 4739 4802:37497 6939 7545 7545 4739 4802:49515 1299 4739 4802:6667 6939 7545 7545 4739 4802:9002 3356 1299 4739 4802:20764 6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:37239 6939 7545 7545 4739 4802:37640 6939 7545 7545 4739 4802:37468 6939 7545 7545 4739 4802:57695 6939 7545 7545 4739 4802:37271 6939 7545 7545 4739 4802:6079 6939 7545 7545 4739 4802:6939 7545 7545 4739 4802:37468 6939 7545 7545 4739 4802:57695 6939 7545 7545 4739 4802:8220 6939 7545 7545 4739 4802:3257 1299 4739 4802:6830 1299 4739 4802:15605 3356 1299 4739 4802:57111 6939 7545 7545 4739 4802:5602 6939 7545 7545 4739 4802:51185 6939 7545 7545 4739 4802:49605 6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:50877 3257 1299 4739 4802:5396 6939 7545 7545 4739 4802:5392 6939 7545 7545 4739 4802:12779 6939 7545 7545 4739 4802:12637 6939 7545 7545 4739 4802:20811 6939 7545 7545 4739 4802:41327 1299 4739 4802:20912 6939 7545 7545 4739 4802:7195 6939 7545 7545 4739 4802:47692 3356 1299 4739 4802:53070 2914 1299 4739 4802:28634 6939 7545 7545 4739 4802:28634 6939 7545 7545 4739 4802:13786 6939 7545 7545 4739 4802:64271 6939 7545 7545 4739 4802:14907 7545 4739 4802:18106 4635 7545 7545 4739 4802:63956 4739 4802:64271 6939 7545 7545 4739 4802:42473 1299 4739 4802:14630 6939 7545 7545 4739 4802:13030 6939 7545 7545 4739 4802:19151 6939 7545 7545 4739 4802:51185 6939 7545 7545 4739 4802:2497 1299 4739 4802:9002 3356 1299 4739 4802:7575 4739 4802:6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:36351 1299 4739 4802:14361 6939 7545 7545 4739 4802:34019 6939 7545 7545 4739 4802:9304 4635 7545 7545 4739 4802:19151 6939 7545 7545 4739 4802:205206 1299 4739 4802:3280 6939 7545 7545 4739 4802:47692 3356 1299 4739 4802:51088 6939 7545 7545 4739 4802:34019 6939 7545 7545 4739 4802:50673 6939 7545 7545 4739 4802:64271 3214 1299 4739 4802:47692 3356 1299 4739 4802:35369 6939 7545 7545 4739 4802:2497 1299 4739 4802:64475 6939 7545 7545 4739 4802:397143 3257 1299 4739 4802:6423 6939 7545 7545 4739 4802:1798 174 1299 4739 4802:42541 6939 7545 7545 4739 4802:209650 6939 7545 7545 4739 4802:37497 6939 7545 7545 4739 4802:328145 6939 7545 7545 4739 4802:3491 7545 7545 4739 4802:37468 6939 7545 7545 4739 4802:24482 6939 7545 7545 4739 4802:1916 6939 7545 7545 4739 4802:22548 6939 7545 7545 4739 4802:16735 6939 7545 7545 4739 4802:23106 6939 7545 7545 4739 4802:52863 6939 7545 7545 4739 4802:28186 6939 7545 7545 4739 4802:57695 6939 7545 7545 4739 4802:52873 12956 1299 4739 4802:267613 52320 6939 7545 7545 4739 4802:28260 12956 1299 4739 4802:4739 4802:263152 6939 7545 7545 4739 4802:7575 4739 4802:262757 3549 3356 1299 4739 4802:28186 6939 7545 7545 4739 4802:58511 4739 4802:30132 1299 4739 4802:24875 6939 7545 7545 4739 4802:3491 4739 4802:24516 1221 2764 4739 4802:4826 4739 4802:15435 6939 7545 7545 4739 4802:24516 1221 2764 4739 4802:14061 7545 4739 4802:24482 7545 4739 4802:8220 7545 4739 4802:137831 1299 4817 7545 4739 4802:58511 7545 4739 4802:17639 7545 4739 4802:7713 7545 4739 4802:38880 4739 4802:7713 7545 4739 4802:12859 6939 7545 7545 4739 4802:137831 3491 7545 7545 4739 4802:19653 3356 1299 4739 4802:395570 6939 7545 7545 4739 4802:293 6453 7545 7545 4739 4802:53828 6939 7545 7545 4739 4802:32709 6939 7545 7545 4739 4802:47147 1299 4739 4802:8218 6939 7545 7545 4739 4802:1103 6939 7545 7545 4739 4802:3491 7545 7545 4739 4802:63956 4739 4802:18106 4635 7545 7545 4739 4802:8218 6939 7545 7545 4739 4802:29686 2914 1299 4739 4802:24961 6939 7545 7545 4739 4802:553 6939 7545 7545 4739 4802:6762 1299 4739 4802:680 1299 1299 4739 4802:55222 6461 1299 4739 4802:57695 6939 7545 7545 4739 4802:6908 6939 7545 7545 4739 4802:2914 1299 4739 4802:48919 174 1299 4739 4802:34288 1299 4739 4802:6720 6939 7545 7545 4739 4802:1140 6939 7545 7545 4739 4802:58511 4739 4802:58511 4739 4802:38726 4635 7545 7545 4739 4802:19653 3356 1299 4739 4802:45177 4739 4802:58511 6939 7545 7545 4739 4802:58511 6939 7545 7545 4739 4802:38001 7545 4739 4802:58511 4739 4802:58511 4739 4802:58511 4739 4802:23367 6461 1299 4739 4802:24482 4739 4802:19151 6939 7545 7545 4739 4802:3267 6939 7545 7545 4739 4802:39120 6939 7545 7545 4739 4802:58511 4739 4802:2497 1299 4739 4802:13237 6939 7545 7545 4739 4802:27678 27986 12956 1299 4739 4802:8607 6939 7545 7545 4739 4802:28329 6939 7545 7545 4739 4802:1916 6939 7545 7545 4739 4802:262757 3549 3356 1299 4739 4802:52863 6939 7545 7545 4739 4802:28571 6939 7545 7545 4739 4802:34224 6939 7545 7545 4739 4802:53767 6939 7545 7545 4739 4802:54728 20130 6939 7545 7545 4739 4802:7500 2497 1299 4739 4802:39120 6939 7545 7545 4739 4802:6908 6939 7545 7545 4739 4802:32354 6939 7545 7545 4739 4802:18106 4635 7545 7545 4739 4802:13030 6939 7545 7545 4739 4802:19016 3257 1299 4739 4802:14630 6939 7545 7545 4739 4802:852 6939 7545 7545 4739 4802:14630 6939 7545 7545 4739 4802:51088 6939 7545 7545 4739 4802:6939 7545 7545 4739 4802:6082 2914 1299 4739 4802:27446 27446 1299 4739 4802:4181 6939 7545 7545 4739 4802:53828 6939 7545 7545 4739 4802:15008 6939 7545 7545 4739 4802:39120 6939 7545 7545 4739 4802:3491 7545 7545 4739 4802:6939 7545 7545 4739 4802:19151 6939 7545 7545 4739 4802:1103 6939 7545 7545 4739 4802:293 6453 7545 7545 4739 4802:14061 6939 7545 7545 4739 4802:39120 6939 7545 7545 4739 4802:49788 6939 7545 7545 4739 4802:39120 6939 7545 7545 4739 4802:3277 3267 6939 7545 7545 4739 4802:3130 6939 7545 7545 4739 4802:39120 6939 7545 7545 4739 4802:20811 6939 7545 7545 4739 4802:25220 6939 7545 7545 4739 4802:29140 6939 7545 7545 4739 4802:8222 6939 7545 7545 4739 4802:26073 6939 7545 7545 4739 4802:60501 41327 1299 4739 4802:2914 1299 4739 4802:6830 1299 4739 4802:267613 52320 6939 7545 7545 4739 4802:5394 6939 7545 7545 4739 4802:12859 6939 7545 7545 4739 4802:1140 6939 7545 7545 4739 4802:20953 6939 7545 7545 4739 4802:39591 6939 7545 7545 4739 4802:58511 6939 7545 7545 4739 4802:34968 6939 7545 7545 4739 4802:12779 6939 7545 7545 4739 4802:1103 6939 7545 7545 4739 4802:50763 6939 7545 7545 4739 4802:47147 1299 4739 4802:206356 6939 7545 7545 4739 4802:58057 6939 7545 7545 4739 4802:49697 6939 7545 7545 4739 4802:47950 6939 7545 7545 4739 4802:3402 6939 7545 7545 4739 4802:29479 50304 1299 4739 4802:39351 6939 7545 7545 4739 4802:3257 1299 4739 4802:3561 209 1299 4739 4802:3292 1299 4739 4802:6939 7545 7545 4739 4802:42541 6939 7545 7545 4739 4802:23367 6461 1299 4739 4802:45352 7545 4739 4802:61568 6939 7545 7545 4739 4802:14840 6939 7545 7545 4739 4802:46450 6939 7545 7545 4739 4802:63927 7545 4739 4802:286 1299 4739 4802:5650 6939 7545 7545 4739 4802:209 1299 4739 4802:209 1299 4739 4802:209 1299 4739 4802:40387 2381 6939 7545 7545 4739 4802:40630 2914 1299 4739 4802:202365 6939 7545 7545 4739 4802:13030 6939 7545 7545 4739 4802:286 1299 4739 4802:25160 6939 7545 7545 4739 4802:6908 6939 7545 7545 4739 4802:62167 6939 7545 7545 4739 4802:8896 6939 7545 7545 4739 4802:7489 6939 7545 7545 4739 4802:12779 6939 7545 7545 4739 4802:60501 41327 1299 4739 4802:39122 1299 4739 4802:207044 6939 7545 7545 4739 4802:57695 6939 7545 7545 4739 4802:60945 6939 7545 7545 4739 4802:51185 6939 7545 7545 4739 4802:8218 6939 7545 7545 4739 4802:6894 6939 7545 7545 4739 4802:6908 6939 7545 7545 4739 4802:31742 6939 7545 7545 4739 4802:35266 6939 7545 7545 4739 4802:19754 6939 7545 7545 4739 4802:1299 4739 4802:6453 7545 7545 4739 4802:14907 1299 4739 4802:8660 1267 6939 7545 7545 4739 4802:24875 6939 7545 7545 4739 4802:34288 1299 4739 4802:133950 9790 4739 4802:38726 9957 2914 1299 4739 4802:36236 4739 4802:2914 1299 4739 4802:2518 4739 4802:63956 6939 7545 7545 4739 4802:42541 6939 7545 7545 4739 4802:61568 6939 7545 7545 4739 4802:59469 1299 4739 4802:34927 6939 7545 7545 4739 4802:31019 6939 7545 7545 4739 4802:38883 4739 4802:56665 1299 4739 4802:204028 6830 1299 4739 4802:1351 6939 7545 7545 4739 4802:6939 7545 7545 4739 4802:39533 6939 7545 7545 4739 4802:8218 6939 7545 7545 4739 4802:29467 6939 7545 7545 4739 4802:59605 1299 4739 4802:50763 6939 7545 7545 4739 4802:8283 1299 4739 4802:8455 6939 7545 7545 4739 4802:199938 6939 7545 7545 4739 4802:47147 1299 4739 4802:60501 41327 1299 4739 4802:20912 6939 7545 7545 4739 4802:23673 7545 4739 4802:852 6939 7545 7545 4739 4802:3130 6939 7545 7545 4739 4802:2914 1299 4739 4802:8492 6939 7545 7545 4739 4802:31019 6939 7545 7545 4739 4802:24441 4635 7545 7545 4739 4802:1239 1299 4739 4802:57866 1299 4739 4802:3257 1299 4739 4802:7018 1299 4739 4802:22652 6939 7545 7545 4739 4802:3741 6939 7545 7545 4739 4802:1403 6939 7545 7545 4739 4802:1299 4739 4802:286 1299 4739 4802:2152 6939 7545 7545 4739 4802:293 6453 7545 7545 4739 4802:1403 6939 7545 7545 4739 4802:701 1299 4739 4802:11686 6939 7545 7545 4739 4802:6939 7545 7545 4739 4802:3549 3356 1299 4739 4802:3549 3356 1299 4739 4802:2497 1299 4739 4802:3561 209 1299 4739 4802:1221 2764 4739 4802:3303 3320 1299 4739 4802:5413 6939 7545 7545 4739 4802:52320 6939 7545 7545 4739 4802:61832 2914 1299 4739 4802:37100 6939 7545 7545 4739 4802:7660 4635 7545 7545 4739 4802:57463 6939 7545 7545 4739 4802:38880 4739 4802:204708 6939 7545 7545 4739 4802|4739"
DEFCON_LINE = "1588205400|190.61.128.0/17|190.61.250.0/24|NEW|18747|18747|47692 3356 174 18747:35369 2914 174 18747:25227 57724 20485 174 18747:29680 174 18747:9002 3257 18747 18747:43578 1299 174 18747:47147 1299 174 18747:8218 6461 174 18747:6720 1853 1764 174 18747:13237 2914 174 18747:513 6830 6830 174 18747:20764 20485 174 18747:24482 174 18747:41722 20764 174 18747:28917 6762 52468 18747 18747 18747 18747 18747:39821 9002 3257 18747 18747:41095 3356 174 18747:2895 3267 174 18747:51907 31133 174 18747:42473 1299 174 18747:64271 62240 3257 18747 18747:29222 174 18747:20932 174 18747:42473 1299 174 18747:12350 174 18747:14630 6461 174 18747:49515 174 18747:29479 9002 3257 18747 18747:6667 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:25091 1299 1299 174 18747:9002 3257 18747 18747:8607 2914 174 18747:2914 174 18747:15547 174 18747:20764 174 18747:24482 174 18747:25091 1299 174 18747:13030 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:286 174 18747:25160 174 18747:6908 1239 174 18747:62167 174 18747:8896 174 18747:7489 62240 3257 18747 18747:12779 3257 18747 18747:60501 57264 174 18747:39122 174 18747:207044 3356 174 18747:57695 58313 25369 174 18747:60945 174 18747:51185 174 18747:8218 6461 174 18747:6894 174 18747:6908 1239 174 18747:31742 174 18747:35266 2914 174 18747:32354 174 18747:14061 2914 174 18747:26073 6939 52468 18747 18747 18747 18747 18747:42275 25091 2914 174 18747:49434 174 18747:35600 35625 174 18747:34019 200780 174 18747:7195 3549 3356 174 18747:41157 41157 41157 174 18747:50628 6453 174 18747:13030 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:58308 29075 174 18747:55222 6461 174 18747:8218 6461 174 18747:19653 174 18747:8218 6461 174 18747:38001 2914 174 18747:37497 174 18747:328145 37271 174 18747:3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:37468 174 18747:6939 52468 18747 18747 18747 18747 18747:6423 6461 174 18747:24516 1299 174 18747:198290 174 18747:19151 52468 18747 18747 18747 18747 18747:51405 206610 1299 174 18747:51185 174 18747:204355 174 18747:9002 3257 18747 18747:15547 174 18747:24482 174 18747:58308 29075 174 18747:9304 174 18747:12779 3257 18747 18747:2497 3257 18747 18747:59689 30781 3356 174 18747:20766 6453 174 18747:29075 174 18747:24482 174 18747:2613 6893 25091 1299 174 18747:57199 35280 3356 174 18747:34177 3356 174 18747:16347 3356 174 18747:8426 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:39533 6762 52468 18747 18747 18747 18747 18747:6082 2914 174 18747:56665 174 18747:27446 27446 174 18747:25091 2914 174 18747:4181 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:23367 6461 174 18747:4739 7545 1299 174 18747:7575 6762 52468 18747 18747 18747 18747 18747:58511 1299 174 18747:3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:24516 1299 174 18747:4826 174 18747:39120 174 18747:397143 3257 18747 18747:14061 2914 174 18747:24482 174 18747:8220 6453 174 18747:137831 1299 174 18747:58511 1299 174 18747:17639 174 18747:7713 3257 18747 18747:7713 3257 18747 18747:137831 1299 174 18747:3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:63956 1299 174 18747:18106 174 18747:2497 3257 18747 18747:53828 2914 174 18747:15008 174 18747:7500 2516 3257 18747 18747:39120 174 18747:39120 174 18747:3402 174 18747:29479 9002 3257 18747 18747:39351 174 18747:3257 18747 18747:3561 209 3356 174 18747:3292 3257 18747 18747:1798 174 18747:6939 52468 18747 18747 18747 18747 18747:42541 174 18747:23367 6461 174 18747:45352 174 18747:61568 37468 174 18747:14840 3356 174 18747:46450 2914 174 18747:63927 1299 174 18747:286 174 18747:3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:19151 52468 18747 18747 18747 18747 18747:11039 4901 11164 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:6830 174 18747:293 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:37497 174 18747:3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:37239 37468 174 18747:37640 37468 174 18747:37468 174 18747:57695 35487 328383 327782 37100 174 18747:37271 174 18747:37697 37497 174 18747:5650 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:209 3356 174 18747:209 3356 174 18747:209 3356 174 18747:40387 11164 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:40630 2914 174 18747:202365 50673 174 18747:5645 1299 174 18747:2914 174 18747:20080 52468 18747 18747 18747 18747 18747:51185 174 18747:393950 6939 52468 18747 18747 18747 18747 18747:52320 52468 18747 18747 18747 18747 18747:19151 52468 18747 18747 18747 18747 18747:5769 174 18747:41095 3356 174 18747:6079 1299 174 18747:6939 52468 18747 18747 18747 18747 18747:58511 1299 174 18747:37468 174 18747:57695 3223 2914 174 18747:8220 1299 174 18747:3257 18747 18747:6830 174 18747:48571 6830 174 18747:31313 174 18747:56430 12310 174 18747:15605 41327 1299 174 18747:57111 174 18747:5602 1299 174 18747:2497 3257 18747 18747:25152 2914 174 18747:4777 2516 3257 18747 18747:51185 6762 52468 18747 18747 18747 18747 18747:49605 174 18747:24482 174 18747:50877 174 18747:5396 3257 18747 18747:5392 3356 174 18747:12779 3257 18747 18747:12637 3257 18747 18747:20811 3356 174 18747:41327 3257 18747 18747:14907 1299 174 18747:18106 174 18747:63956 1299 174 18747:20912 174 18747:2914 174 18747:205206 1299 174 18747:51873 6830 174 18747:34019 3303 174 18747:47692 3356 174 18747:64475 50629 174 18747:34019 3303 174 18747:14061 2914 174 18747:3280 43376 174 18747:47692 3356 174 18747:49605 174 18747:19151 52468 18747 18747 18747 18747 18747:7575 6762 52468 18747 18747 18747 18747 18747:196621 15576 174 18747:14907 2914 174 18747:198385 174 18747:2497 3257 18747 18747:8218 6461 174 18747:1280 5511 52468 18747 18747 18747 18747 18747:25091 1299 174 18747:51088 3257 18747 18747:6762 52468 18747 18747 18747 18747 18747:2497 3257 18747 18747:7575 6762 52468 18747 18747 18747 18747 18747:6939 52468 18747 18747 18747 18747 18747:36351 52468 18747 18747 18747 18747 18747:61955 174 18747:14361 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:53070 2914 174 18747:51088 3257 18747 18747:19151 52468 18747 18747 18747 18747 18747:39120 174 18747:19653 174 18747:28634 37468 174 18747:28634 37468 174 18747:395570 40028 1299 174 18747:13786 12956 174 18747:293 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:64271 262287 6762 52468 18747 18747 18747 18747 18747:53828 2914 174 18747:32709 32703 174 18747:19151 52468 18747 18747 18747 18747 18747:14630 3356 174 18747:852 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:14630 1299 174 18747:24482 174 18747:34019 200780 174 18747:50673 174 18747:1916 52468 18747 18747 18747 18747 18747:64271 3214 3257 18747 18747:22548 3549 3356 174 18747:42541 174 18747:20612 1836 174 18747:209650 209844 56381 3257 18747 18747:30132 6762 52468 18747 18747 18747 18747 18747:20612 1836 174 18747:24875 1299 174 18747:16735 52468 18747 18747 18747 18747 18747:58511 1299 174 18747:58511 1299 174 18747:38726 9304 15412 174 18747:45177 174 18747:58511 3257 18747 18747:58511 1299 174 18747:58511 1299 174 18747:58511 1299 174 18747:58511 3257 18747 18747:24482 174 18747:3267 174 18747:39120 174 18747:39120 174 18747:19754 1299 174 18747:1299 174 18747:34288 174 18747:133950 9790 4826 174 18747:38726 9957 174 18747:36236 174 18747:2914 174 18747:2518 174 18747:63956 1299 174 18747:42541 174 18747:61568 37468 174 18747:59469 1299 174 18747:38883 4826 174 18747:56665 174 18747:204028 6830 174 18747:1351 6939 52468 18747 18747 18747 18747 18747:13030 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:6939 52468 18747 18747 18747 18747 18747:52320 52468 18747 18747 18747 18747 18747:61832 2914 174 18747:23106 174 18747:52863 3356 174 18747:28186 174 18747:1103 2603 6762 52468 18747 18747 18747 18747 18747:34224 6453 174 18747:293 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:53767 3257 18747 18747:6830 174 18747:54728 20130 23352 3257 18747 18747:267613 174 18747:18106 174 18747:5394 3257 18747 18747:49788 174 18747:12859 2914 174 18747:3277 3267 174 18747:1140 24785 1299 174 18747:57695 262287 6762 52468 18747 18747 18747 18747 18747:20953 174 18747:39591 174 18747:58511 3257 18747 18747:34968 8455 1299 174 18747:52873 12956 174 18747:3130 1239 174 18747:20912 174 18747:23673 174 18747:852 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:3130 2914 174 18747:2914 174 18747:8492 20764 174 18747:267613 174 18747:28260 12956 174 18747:263152 28329 3356 174 18747:262757 4230 174 18747:28186 174 18747:31019 39326 1299 174 18747:58299 174 18747:59891 51395 1299 174 18747:15547 174 18747:31424 3257 18747 18747:58057 174 18747:62167 174 18747:24482 174 18747:51786 15623 174 18747:8218 6461 174 18747:29686 6453 174 18747:21232 15576 174 18747:24961 3356 174 18747:553 174 18747:47147 1299 174 18747:6762 52468 18747 18747 18747 18747 18747:680 1299 1299 174 18747:8758 174 18747:12779 3257 18747 18747:1103 2603 6762 52468 18747 18747 18747 18747 18747:50763 8943 1299 174 18747:24875 1299 174 18747:31019 39326 1299 174 18747:202194 198385 174 18747:12307 29691 6830 174 18747:29691 6830 174 18747:59414 6830 174 18747:8660 1267 3356 174 18747:57695 3223 2914 174 18747:6908 1239 174 18747:2914 174 18747:48919 174 18747:34288 174 18747:20811 3356 174 18747:25220 2914 174 18747:29140 174 174 18747:8222 1299 174 18747:60501 57264 174 18747:47147 1299 174 18747:206356 50629 174 18747:58057 39533 6453 174 18747:49697 39912 1299 174 18747:47950 1299 174 18747:34927 58299 174 18747:39533 6453 174 18747:15435 174 18747:12859 2914 174 18747:1103 2603 6762 52468 18747 18747 18747 18747 18747:1140 24785 1299 174 18747:6908 1239 174 18747:6453 174 18747:14907 38930 174 18747:8218 6461 174 18747:29467 2914 174 18747:59605 174 18747:50763 8943 1299 174 18747:8283 38930 174 18747:8455 1299 174 18747:199938 201709 8881 174 18747:47147 1299 174 18747:60501 57264 174 18747:24441 1299 1299 1299 174 18747:1239 174 18747:57866 2914 174 18747:3257 18747 18747:7018 174 18747:22652 174 18747:3741 174 18747:1403 174 18747:1299 174 18747:286 174 18747:2152 11164 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:293 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:1403 174 18747:701 174 18747:11686 52468 18747 18747 18747 18747 18747:6939 52468 18747 18747 18747 18747 18747:3549 3356 174 18747:3549 3356 174 18747:2497 3257 18747 18747:3561 209 3356 174 18747:1221 4637 3257 18747 18747:3303 174 18747:5413 3491 52468 52468 52468 52468 18747 18747 18747 18747 18747:37100 174 18747:7660 2516 3257 18747 18747:28329 3356 174 18747:1916 52468 18747 18747 18747 18747 18747:262757 4230 174 18747:52863 3356 174 18747:28571 1916 52468 18747 18747 18747 18747 18747:6939 52468 18747 18747 18747 18747 18747:27678 18747:205344 3356 174 18747:57463 6762 52468 18747 18747 18747 18747 18747:204708 20766 6453 174 18747|27678 18747"


class TestPfxEvent(TestCase):
    def setUp(self):
        parsers = {
            "moas": PfxEventParser("moas"),
            "submoas": PfxEventParser("submoas"),
            "defcon": PfxEventParser("defcon"),
            "edges": PfxEventParser("edges"),
        }
        self.moas_pfx_event = parsers["moas"].parse_line(MOAS_LINE)
        self.edges_pfx_event = parsers["edges"].parse_line(EDGES_LINE)
        self.submoas_pfx_event = parsers["submoas"].parse_line(SUBMOAS_LINE)
        self.defcon_pfx_event = parsers["defcon"].parse_line(DEFCON_LINE)
        self.maxDiff=None

    def test_get_event_id(self):
        self.assertEqual(self.moas_pfx_event.get_event_id(), "moas-1588205400-263038_265436")
        self.assertEqual(self.submoas_pfx_event.get_event_id(), "submoas-1588205400-4802=4739")
        self.assertEqual(self.defcon_pfx_event.get_event_id(), "defcon-1588205400-18747")
        self.assertEqual(self.edges_pfx_event.get_event_id(), "edges-1588205400-136620_8551")

    def test_get_fingerprint(self):
        self.assertEqual(self.moas_pfx_event.get_recurring_fingerprint(), "263038_265436-168.195.168.0-22")
        self.assertEqual(self.submoas_pfx_event.get_recurring_fingerprint(), "4802=4739-202.45.96.0-19_202.45.108.182-32")
        self.assertEqual(self.defcon_pfx_event.get_recurring_fingerprint(), "18747-190.61.128.0-17_190.61.250.0-24")
        self.assertEqual(self.edges_pfx_event.get_recurring_fingerprint(), "136620_8551")

    def test_as_dict(self):
        self.assertEqual(self.moas_pfx_event.as_dict(False),
                         {'details': {'aspaths': '',
                                      'new_origins': ['265436', '263038'],
                                      'old_origins': [],
                                      'origins': ['265436', '263038'],
                                      'prefix': '168.195.168.0/22'},
                          'position': 'NEW',
                          'event_type': 'moas',
                          'extra': {},
                          'finished_ts': None,
                          'tags': [],
                          'inferences': [],
                          'victims': [],
                          'attackers': ['265436', '263038'],
                          'traceroutes': {'msms': [], 'worthy': False, 'worthy_tags': []},
                          'view_ts': 1588205400}
                         )
        self.assertEqual(self.submoas_pfx_event.as_dict(False),
                         {'details': {'sub_aspaths': '',
                                      'sub_new_origins': ['4739'],
                                      'sub_old_origins': [],
                                      'sub_origins': ['4739'],
                                      'sub_pfx': '202.45.108.182/32',
                                      'super_aspaths': '',
                                      'super_new_origins': ['4802'],
                                      'super_old_origins': [],
                                      'super_origins': ['4802'],
                                      'super_pfx': '202.45.96.0/19'},
                          'position': 'NEW',
                          'event_type': 'submoas',
                          'extra': {},
                          'finished_ts': None,
                          'tags': [],
                          'inferences': [],
                          'victims': ["4802"],
                          'attackers': ['4739'],
                          'traceroutes': {'msms': [], 'worthy': False, 'worthy_tags': []},
                          'view_ts': 1588205400}
                         )
        self.assertEqual(self.defcon_pfx_event.as_dict(False),
                         {'details': {'new_origins': ['18747'],
                                      'old_origins': [],
                                      'origins': ['18747'],
                                      'sub_aspaths': '',
                                      'sub_pfx': '190.61.250.0/24',
                                      'super_aspaths': '',
                                      'super_pfx': '190.61.128.0/17'},
                          'position': 'NEW',
                          'event_type': 'defcon',
                          'extra': {},
                          'finished_ts': None,
                          'tags': [],
                          'inferences': [],
                          'victims': ['18747'],
                          'attackers': [],
                          'traceroutes': {'msms': [], 'worthy': False, 'worthy_tags': []},
                          'view_ts': 1588205400}
                         )
        self.assertEqual(self.edges_pfx_event.as_dict(False),
                         {'details': {'as1': 136620,
                                      'as2': 8551,
                                      'aspaths': '',
                                      'aspaths_with_newedge': '',
                                      'prefix': '79.180.229.0/24'},
                          'position': 'NEW',
                          'event_type': 'edges',
                          'extra': {},
                          'finished_ts': None,
                          'tags': [],
                          'inferences': [],
                          'victims': ['64635', '8551'],
                          'attackers': [],
                          'traceroutes': {'msms': [], 'worthy': False, 'worthy_tags': []},
                          'view_ts': 1588205400}
                         )

    def test_from_dict(self):
        self.assertIsInstance(PfxEvent.from_dict(self.moas_pfx_event.as_dict()), PfxEvent)
        self.assertIsInstance(PfxEvent.from_dict(self.submoas_pfx_event.as_dict()), PfxEvent)
        self.assertIsInstance(PfxEvent.from_dict(self.defcon_pfx_event.as_dict()), PfxEvent)
        self.assertIsInstance(PfxEvent.from_dict(self.edges_pfx_event.as_dict()), PfxEvent)

    def test_add_tags(self):
        tags_set = {
            tagshelper.get_tag("all-newcomers"),
            tagshelper.get_tag("no-newcomer"),
        }
        self.moas_pfx_event = PfxEventParser("moas").parse_line(MOAS_LINE)
        self.moas_pfx_event.add_tags(tags_set)
        self.assertEqual(self.moas_pfx_event.tags, tags_set)

        self.moas_pfx_event = PfxEventParser("moas").parse_line(MOAS_LINE)
        self.moas_pfx_event.add_tags(list(tags_set))
        self.assertEqual(self.moas_pfx_event.tags, tags_set)

        self.moas_pfx_event = PfxEventParser("moas").parse_line(MOAS_LINE)
        self.moas_pfx_event.add_tags([tag.name for tag in tags_set])
        self.assertEqual(self.moas_pfx_event.tags, tags_set)
